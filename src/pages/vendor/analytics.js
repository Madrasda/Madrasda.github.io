import VendorLayout from '@/components/layout-vendor'
import Table from '@/components/table'
import Head from 'next/head'
import PieChart from '@/components/piechart'
import LineGraph from '@/components/linegraph'
import axios from "axios";
import { useEffect } from "react";
import { useRouter } from "next/router";
export default function Analytics () {
  const router = useRouter();

  const verifyToken = async () => {
    const url = new URLSearchParams({
      token: localStorage.getItem('token')
    })
    axios.get(
      "http://localhost:8080/api/auth/?" + url
    ).then((response) => {
      console.log("refreshed");
    }).catch((err) => {
      localStorage.removeItem("token");
      router.push("/vendor");
    })
  }
  useEffect(()=>{
    const token = localStorage.getItem("token");
    if (!token) {
      router.push("/vendor");
    } else {
      try {
        verifyToken();
      } catch (err) {
        router.push("/vendor");
      }
    }
  }, []);



  return (
    <>
      <Head>
        <title>Create Next App</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/logo.png" />
        <title>Madrasda | Analytics</title>
      </Head>
      
      <VendorLayout>
      <main className='body-font font-algeria overflow-hidden 
                       md:ml-36'>
      <div className="px-5 my-10 mx-auto">
        <div className="md:ml-20 md:mt-10">
          <h1 className="title-font font-medium text-primary text-3xl">HERE IS YOUR ANALYSIS</h1>
          <h2 className="title-font font-bold text-2xl">KHHK!</h2>
        </div>
{/* -------- STATISTICS -------- */}
        <section className="text-gray-600 body-font">
              <div className="container px-5 py-14 mx-auto">
                  <div className="flex flex-wrap -m-4 text-center md:ml-2">
                  <div className="p-4 w-1/2">
                      <h1 className="title-font font-bold text-xl">Total Products</h1>
                      <h2 className="title-font font-bold text-3xl text-primary">52</h2>
                      <p className="leading-relaxed text-xs">40% more than previous 28 days</p>
                  </div>
                  <div className="p-4 w-1/2">
                      <h1 className="title-font font-bold text-xl">Total Orders</h1>
                      <h2 className="title-font font-bold text-3xl text-primary">1002</h2>
                      <p className="leading-relaxed text-xs">460% more than previous 28 days</p>
                  </div> 
                  <div className="p-4 w-1/2">
                      <h1 className="title-font font-bold text-xl">Total Printwear Profit</h1>
                      <h2 className="title-font font-bold  text-3xl text-primary">₹11067</h2>
                      <p className="leading-relaxed text-xs">460% more than previous 28 days</p>
                  </div>
                  <div className="p-4 w-1/2">
                      <h1 className="title-font font-bold text-xl">Total Profit Earned</h1>
                      <h2 className="title-font font-bold  text-3xl text-primary">₹150254</h2>
                      <p className="leading-relaxed text-xs">460% more than previous 28 days</p>
                  </div>
                  </div>
              </div>  
          </section>
{/* --------- STATISTICS END -------- */}

{/* --------- LINE GRAPH -------- */}
          <h2 className='text-primary font-semibold text-2xl
                        md:mt-20 md:ml-20'>Sales Profit</h2>
          <div className='flex justify-center items-center
                          md:ml-20 '>
            <LineGraph />
          </div>
{/* --------- LINE GRAPH END -------- */}

{/* --------- PIE CHART -------- */}
          <h2 className='-mt-[140%] text-primary font-semibold text-2xl
                          md:ml-20 md:-mt-[80%]
                          lg:-mt-72'>Product Contribution</h2>
          <div className='flex justify-center items-center
                          md:ml-20'>
            <PieChart />
          </div>
{/* --------- PIE CHART END -------- */}

{/* -------- TABLE ------- */}
          <h2 className='text-primary font-semibold text-2xl
                        md:mt-20 md:ml-20'>Product Ladder</h2>
          <div className='mt-4
                          md:ml-20'>
            <Table />
          </div>  
{/* -------- TABLE END ------- */}
        </div>
        </main>
        </VendorLayout>
    </>
  )
}